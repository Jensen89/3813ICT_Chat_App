<!-- src/app/components/groups/groups.component.html -->
<div class="groups-container">
  <!-- Header -->
  <div class="header">
    <h1>Groups Management</h1>
    <button (click)="navigateToDashboard()" class="btn-back">Back to Dashboard</button>
  </div>

  <!-- Messages -->
  <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>
  <div *ngIf="successMessage" class="success-message">{{ successMessage }}</div>

  <!-- Create Group Section (Group Admins only) -->
  <div class="create-section" *ngIf="isGroupAdmin()">
    <button *ngIf="!showCreateForm" (click)="showCreateForm = true" class="btn-primary">
      Create New Group
    </button>
    
    <div *ngIf="showCreateForm" class="create-form">
      <h3>Create New Group</h3>
      <input 
        type="text" 
        [(ngModel)]="newGroupName" 
        placeholder="Enter group name"
        (keyup.enter)="createGroup()">
      <div class="form-buttons">
        <button (click)="createGroup()" class="btn-primary">Create</button>
        <button (click)="showCreateForm = false; newGroupName = ''" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Add Member Section (Admins only) -->
  <div class="add-member-section" *ngIf="isGroupAdmin()">
    <h3>Add Member to Group</h3>
    <div class="add-member-form">
      <select [(ngModel)]="selectedGroupId">
        <option value="">Select Group...</option>
        <option *ngFor="let group of allGroups" 
                [value]="group.id"
                [disabled]="!canManageGroup(group)">
          {{ group.name }} {{ !canManageGroup(group) ? '(No permission)' : '' }}
        </option>
      </select>
      
      <select [(ngModel)]="selectedUserId">
        <option value="">Select User...</option>
        <option *ngFor="let user of allUsers" [value]="user.id">
          {{ user.username }} ({{ user.email }})
        </option>
      </select>
      
      <button (click)="addMemberToGroup()" class="btn-primary">Add Member</button>
    </div>
  </div>

  <!-- Groups List -->
  <div class="groups-list">
    <h2>All Groups</h2>
    
    <div *ngIf="allGroups.length === 0" class="no-groups">
      <p>No groups have been created yet.</p>
    </div>
    
    <div class="groups-grid">
      <div class="group-card" *ngFor="let group of allGroups">
        <div class="group-header">
          <h3>{{ group.name }}</h3>
          <span class="member-count">{{ group.members.length }} members</span>
        </div>
        
        <div class="group-info">
          <p class="members-preview">
            Members: {{ getGroupMembers(group) }}
          </p>
        </div>
        
        <div class="group-actions">
          <!-- View Channels (for members) -->
          <button 
            *ngIf="isMemberOfGroup(group)" 
            (click)="navigateToChannels(group.id)" 
            class="btn-primary">
            View Channels
          </button>
          
          
          <!-- Join/Leave Group -->
          <button 
            *ngIf="!isMemberOfGroup(group)" 
            (click)="joinGroup(group)" 
            class="btn-secondary">
            Join Group
          </button>
          
          <button 
            *ngIf="isMemberOfGroup(group) && !canManageGroup(group)" 
            (click)="leaveGroup(group)" 
            class="btn-warning">
            Leave Group
          </button>
          
          <!-- Admin Actions -->
          <button 
            *ngIf="canManageGroup(group)" 
            (click)="deleteGroup(group)" 
            class="btn-danger">
            Delete Group
          </button>
        </div>
        
        <!-- Admin Badge -->
        <div *ngIf="canManageGroup(group)" class="admin-badge">
          You are admin
        </div>
      </div>
    </div>
  </div>
</div>